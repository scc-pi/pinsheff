[{"path":"index.html","id":"welcome","chapter":"Welcome","heading":"Welcome","text":"place ad-hoc notes, mainly scripting mainly R scripts. ’s somewhere store lessons learnt examples. resource remind return something away , smooth path little ’s something new.many excellent online resources notes point attempt replace. Overtime notes may mature package vignettes become accepted good practice included Methods Manual.Hopefully, others Performance & Intelligence Team, elsewhere Sheffield City Council, contribute notes. However, currently ’s just one person biased one person’s recent experience: ETL, geocoding spatial analysis. Notes modelling visualisations lacking.well contributors content, purpose scope open change. hope find notes useful.","code":""},{"path":"github.html","id":"github","chapter":"1 Version Control & GitHub","heading":"1 Version Control & GitHub","text":"don’t familiar version control, Git GitHub make use notes contents scc-pi repositories. ’re new scripting R, visualisations using R Markdown better starting points version control.notes public, contribute .e. edit , need GitHub account granted permission owner scc-pi (try Laurie first, Giles Anne help ). can edit directly GitHub via browser.also need GitHub account permission access one private repositories, public repositories, download file, copy & paste code, source use function:Try raising issue spot problem, suggestion question.","code":"\n# Load functions from a public scc-pi repository \nsource(\"https://raw.githubusercontent.com/scc-pi/functions/main/Examples.R\")\n\n# Call one of our Sheffield area functions that returns LSOA codes \nshef_lsoa_codes() %>% \n  head(5) %>% #only display the first 5 records\n  knitr::kable() #display them in a nice table ## [1] \"Table\""},{"path":"github.html","id":"why-version-control","chapter":"1 Version Control & GitHub","heading":"1.1 Why version control?","text":"scripting might make backup copy file, new changes break previously working can revert backup copy. ’re collating contributions document different people might use initials file names indicate keep track ’s made contributions version e.g. “BI_Principles-GR.docx” “BI_Principles-NM.docx”. examples manual version control.talk version control scripting typically mean version control system. tool assists tracking changes files time different people. systems also usually include reasons changes, file, rather version, comparison functionality. version control system backup/audit trail/collaboration thing.","code":""},{"path":"github.html","id":"git","chapter":"1 Version Control & GitHub","heading":"1.2 GIT","text":"Git open-source distributed version control system tracking changes source code software development.","code":""},{"path":"github.html","id":"github-1","chapter":"1 Version Control & GitHub","heading":"1.3 GitHub","text":"GitHub product offers Git-based source control repositories. products also offer Git-based repositories, GitLab, BitBucket, Azure DevOps.scc-pi GitHub organisation free account. approval . using proves successful need discuss approval BCIS.","code":""},{"path":"github.html","id":"github-security","chapter":"1 Version Control & GitHub","heading":"1.3.1 GitHub security & data protection","text":"Assuming GitHub.com hosted US, meet data protection obligations. Either way, ’ve checked compliance Information Governance, storing PID (Person Identifiable Data), anything commercially confidential politically sensitive, GitHub.com currently -..gitignore file lists folders files want exclude repository .e. specifies want ignore. Holding file based data (e.g. CSV files), whether ’re original transformed, /data sub-folder, makes simple exclude data repository adding following .gitignore file:additional precaution, projects involving confidential information held private repository .Rdata also included .gitignore file (see section RStudio security & data protection):Microsoft GitHub GitHub Enterprise Server -premises deployment GitHub.com hosted Azure environment.","code":"# data directory\n/data/\n# Session Data files\n.RData"},{"path":"github.html","id":"forking-pull-requests","chapter":"1 Version Control & GitHub","heading":"1.3.2 Forking & pull requests","text":"GitHub forking pull requests common workflows collaborating repository.TODO - ’ll add ’ve collaborated repository","code":""},{"path":"github.html","id":"other-features","chapter":"1 Version Control & GitHub","heading":"1.3.3 Other features","text":"GitHub now allows private repositories free organisation accounts, GitHub features available.evolution repository captured commits .e. changes files repository. However, original issue, ideas discussion surrounding commit captured GitHub issue. can link commit issue including issue number prefixed # commit message.’ve used GitHub project organise private C19Surveillance repository kanban board. However, project restricted issues single repository.GitHub pages actions used publish notes.also GitHub features explore.","code":""},{"path":"github.html","id":"git-rstudio","chapter":"1 Version Control & GitHub","heading":"1.4 Git & RStudio","text":"Introduction GitHub GitHub Learning Lab good place get started become familiar initial concepts GitHub website.use GitHub RStudio ’s thorough step--step guide, Happy Git R Jenny Bryan. main recommendation setup connection using keys SSH. connection method -passes issues ’ve Council’s proxy server using HTTPS connection method. ’ve also issues since working home connecting via Tunnel. Infact, since August 2021 GitHub token authentication required (e.g. SSH) steps Jenny Bryan’s book (e.g. chapters 9 10 connecting HTTPS) date. October 2021 case, issue #181 gets closed Happy Git R GitHub repo, ’s fixed. recommendation skip chapters 9 10 focus 11 15 (SSH New project, GitHub first).frequently return Jenny Bryan’s book, especially chapters 15, 16 17 different ways setting local RStudio project connected GitHub. far, ’ve mainly stuck Chapter 15 New project, GitHub first.","code":""},{"path":"r.html","id":"r","chapter":"2 R & RStudio","heading":"2 R & RStudio","text":"","code":""},{"path":"r.html","id":"why-script","chapter":"2 R & RStudio","heading":"2.1 Why script?","text":"initially started scripting Python automate spatial analysis tasks, soon realised reproducibility main advantage. Iterating, improving process incrementally end verifying results re-running script.’s element self-documentation scripting, ’s easier return scripted task bit time away , pick scripted task colleague. However, -line comments adherence style guide make big difference just easy . Version control collaboration also easier scripting GUI tools.Scripting always better using GUI tools. ’s good reason people use Mac OS Windows Unix Bash. Scripting GUI tools horses courses question, GUI workflow tools (e.g. FME, Simul8 ModelBuilder ArcGIS) sit somewhere middle.","code":""},{"path":"r.html","id":"style-guide","chapter":"2 R & RStudio","heading":"2.2 Style guide","text":"Something need pay attention following tidyverse style guide, benefits supporting tools familiarity via tidyverse package documentation.Scripting style guide makes collaboration easier. style guide less important collaborators scripting style guide.","code":""},{"path":"r.html","id":"pid","chapter":"2 R & RStudio","heading":"2.3 RStudio security & data protection","text":"","code":""},{"path":"r.html","id":"workspace","chapter":"2 R & RStudio","heading":"2.3.1 Workspace","text":"encourage reproducible R scripts, Hadley Wickham recommends preserving workspace sessions. entails deselecting couple options save restore .Rdata (see chapter 8 Workflow: projects Hadley’s R4DS book).Hadley’s recommendation also reduces chances inadvertently sharing PID GitHub repository. However, .Rdata also included .gitignore file repository set private (see section GitHub security & data protection).","code":""},{"path":"r.html","id":"passwords","chapter":"2 R & RStudio","heading":"2.3.2 Passwords","text":"’s poor practice include login details code. use .Renviron file option securing credentials. However, ’re sharing script can anticipate environment variable might set use RStudio API prompt credentials. example:","code":"\nportal_pwd <- Sys.getenv(\"portal_pwd\")\nif(length(portal_pwd) == 0){\n  portal_pwd <- rstudioapi::askForPassword(\"Portal password\")\n}"},{"path":"r.html","id":"getting-started","chapter":"2 R & RStudio","heading":"2.4 Getting started","text":"’m going provide advice getting started, signposting excellent resources listed RStudio beginners page:RStudio Education - BeginnersHadley Wickham’s R Data Science main book people use new R. However, already coding experience Succinct Intro R Steve Haroz useful.","code":""},{"path":"r.html","id":"rstudio-tips","chapter":"2 R & RStudio","heading":"2.5 RStudio tips","text":"","code":""},{"path":"r.html","id":"code-display","chapter":"2 R & RStudio","heading":"2.5.1 Code display","text":"non-default Global Options, Code Display, make little easier read write code:Show margin (aim limit line code 80 characters)Show margin (aim limit line code 80 characters)Highlight R function callsHighlight R function callsRainbow parentheses (since RStudio v1.4)Rainbow parentheses (since RStudio v1.4)","code":""},{"path":"r.html","id":"document-outline-headings","chapter":"2 R & RStudio","heading":"2.5.2 Document outline & headings","text":"Code sections subsections useful:sections can collapsed also listed document outline pane:","code":"\n# Prefix a section with a hash tag and suffix with 4 or more dashes ----\n## Subsections have additional hash tags ----"},{"path":"r.html","id":"viewpipesteps-addin","chapter":"2 R & RStudio","heading":"2.5.3 ViewPipeSteps addin","text":"pipe %>% useful reading writing code, can make debugging cumbersome. ViewPipeSteps addin lets view output pipe chain step. install:use:","code":"\ndevtools::install_github(\"daranzolin/ViewPipeSteps\")\nlibrary(ViewPipeSteps)"},{"path":"r.html","id":"shortcuts","chapter":"2 R & RStudio","heading":"2.5.4 Shortcuts","text":"RStudio lots shortcuts. find useful preference areas IDE use often. shortcuts ’ve found useful:","code":""},{"path":"r.html","id":"further-resources","chapter":"2 R & RStudio","heading":"2.6 Further resources","text":"5 tips writing clean R code, Marcin Dubel R bloggers (15 March 2021)","code":""},{"path":"rmd.html","id":"rmd","chapter":"3 R Markdown","heading":"3 R Markdown","text":"","code":""},{"path":"rmd.html","id":"r-markdown-vs-markdown","chapter":"3 R Markdown","heading":"3.1 R Markdown vs Markdown","text":"Markdown markup language creating formatted text using plain-text editor. main aim readability, simple, unobtrusive syntax readable -, unlike text formatted markup language RTF HTML. raw markdown document easy read, well final rendered output.GitHub ’s flavour markdown, commonly used README.md file serves introduce GitHub repository.R Markdown another flavour markdown. combines reproducible manner: code, output, commentary. R Markdown documents support different output formats, like PDFs, Word files, slideshows, HTML. Hadley Wickham lists three main uses R Markdown files :communicating decision makers, want focus conclusions, code behind analysis.communicating decision makers, want focus conclusions, code behind analysis.collaborating data scientists (including future !), interested conclusions, reached (.e. code).collaborating data scientists (including future !), interested conclusions, reached (.e. code).environment data science, modern day lab notebook can capture , also thinking.environment data science, modern day lab notebook can capture , also thinking.","code":""},{"path":"rmd.html","id":"notebooks","chapter":"3 R Markdown","heading":"3.2 Notebooks","text":"TODO - technical vs data exploration - don’t add github","code":""},{"path":"rmd.html","id":"bookdown","chapter":"3 R Markdown","heading":"3.3 Bookdown","text":"notes written using bookdown package, built top R Markdown knitr.Rmd file contains one one chapter, chapter defined first-level heading #.","code":""},{"path":"rmd.html","id":"themes","chapter":"3 R Markdown","heading":"3.3.1 Themes","text":"theme notes changed September 2021 GitBook style Three-column Bootstrap style.","code":""},{"path":"rmd.html","id":"publishing","chapter":"3 R Markdown","heading":"3.3.2 Publishing","text":"notes published GitHub Pages GitHub Actions. GitHub Action configured start ’s push master branch. Action renders Rmd files master branch HTML deploys HTML files static website branch called gh-pages. Alternatives using GitHub Actions include Travis Jekyll.used steps outlined following blog post: publish bookdown projects GitHub Actions GitHub Pages. However, lot git bash commands manually couple fixes made deploy_bookdown.yaml file:1. …… added …2. used GITHUB_TOKEN rather GH_PAT, per change GitHub-Pages-deploy.","code":"uses: Cecilapp/GitHub-Pages-deploy@masterwith:       \n  build_dir: _book/       \n  email: ${{ secrets.EMAIL }}"},{"path":"rmd.html","id":"flexdashboard","chapter":"3 R Markdown","heading":"3.4 Flexdashboard","text":"goal flexdashboard make easy create interactive dashboards R, using R Markdown.pkgs.rstudio.com/flexdashboardFlexdashboards don’t functionality Power BI, allow data input like Shiny. However, simple quick create. can good option dashboard unlikely maintained beyond specific project. flexdashboard output simply HTML file, ’s useful need share dashboard people outside organisation. ’re also obviously good option ’ve done data analysis preparatory work R. Council’s imminent upgrade SharePoint fuller MS Teams functionality, really useful way publish flexdashboards.TODO: Test whether fexdashboard can hosted via Power BI Report Server IFrame.","code":""},{"path":"rmd.html","id":"rolldown","chapter":"3 R Markdown","heading":"3.5 Rolldown","text":"Rolldown R Markdown extension builds scroll-driven HTML documents storytelling, .k.scrollytelling.’s similar ArcGIS StoryMaps proved popular people might familiar .","code":""},{"path":"rmd.html","id":"child-markdown-iteration","chapter":"3 R Markdown","heading":"3.6 Child markdown iteration","text":"TODO - GIST - example based C19 UoS example - prominent technique demand reports largely superseded browser based dashboards provided via Power BI Shiny.","code":""},{"path":"rmd.html","id":"r-markdown-tips","chapter":"3 R Markdown","heading":"3.7 R Markdown tips","text":"","code":""},{"path":"rmd.html","id":"markdown-visual-editor","chapter":"3 R Markdown","heading":"3.7.1 Markdown visual editor","text":"RStudio v1.4 release includes visual editor markdown, makes like using MS Word:","code":""},{"path":"rmd.html","id":"chunk-named-setup","chapter":"3 R Markdown","heading":"3.7.2 Chunk named setup","text":"Naming code block setup means restart RStudio execute code middle markdown document, setup block run first. example, make sure libraries loaded first:","code":"```{r, setup, message = FALSE, warning = FALSE}\n# Packages\nlibrary(tidyverse)```"},{"path":"rmd.html","id":"further-resources-1","chapter":"3 R Markdown","heading":"3.8 Further resources","text":"Chapter 27 R Markdown, R4DS Hadley Wickham.Authoring Books Technical Documents R Markdown Yihui Xie definitive resource R Markdown.","code":""},{"path":"api.html","id":"api","chapter":"4 APIs","heading":"4 APIs","text":"","code":""},{"path":"api.html","id":"rest-apis","chapter":"4 APIs","heading":"4.1 REST APIs","text":"RESTfulTODO\n- Foundation Council services","code":""},{"path":"api.html","id":"wrappers","chapter":"4 APIs","heading":"4.2 Wrappers","text":"TODO","code":""},{"path":"api.html","id":"rectangling","chapter":"4 APIs","heading":"4.3 Rectangling","text":"Data returned REST APIs typically provided hierarchical structure JSON common format. tidyverse Rectangling vignette explains structure data API familiar tabular structure.TODO\nscc-pi functions rectangling e.g. postcode geocoding\"# Python {#python}Python R popular data analysis scripting languages. Python general-purpose language easy--understand syntax. R’s functionality developed statisticians mind popular academia research.","code":""},{"path":"api.html","id":"reticulate","chapter":"4 APIs","heading":"4.4 Reticulate","text":"reticulate R package allows R integrate Python. RStudio v1.4 embedded reticulate IDE. example, can define default Python environment Global Options Project Options. can also now inspect Python objects RStudio Environment pane.","code":""},{"path":"api.html","id":"arcgis-api-wrappers","chapter":"4 APIs","heading":"4.5 ArcGIS & API wrappers","text":"Council’s ArcGIS software ESRI much stronger integration Python R (see section ArcGIS R & Python packages notes ). Similarly, may find Python packages corresponding R package REST API “wrappers” make easier obtain data (see section wrappers notes ). cases, reticulate allows us leverage Python packages within R.","code":""},{"path":"gis.html","id":"gis","chapter":"5 GIS","heading":"5 GIS","text":"section aimed Council data analysts little experience spatial data GIS. GIS traditionally domain specialists especially true Council. However, Council’s new web based GIS tools open GIS wider user base, better opportunities data analysts make use spatial data without GIS specialist.word warning jump , guidance, examples functions targeted helping use spatial data still much work--progress (TODO).","code":""},{"path":"gis.html","id":"spatial-data","chapter":"5 GIS","heading":"5.1 Spatial data","text":"","code":""},{"path":"gis.html","id":"councils-spatial-data","chapter":"5 GIS","heading":"5.1.1 Council’s spatial data","text":"Council’s spatial data hosted ESRI’s ArcGIS web GIS tools.Portal (ArcGIS Enterprise) Council-wide:sheffieldcitycouncil.cloud.esriuk.com/portal/homeArcGIS Online (AGOL) public facing equivalent Portal:sheffieldcc.maps.arcgis.comUnlike R, ArcGIS open source incurs financial cost. Portal AGOL require login credentials licensing data protection purposes. exception, public data AGOL, example Council’s open data site:data-sheffieldcc.opendata.arcgis.com","code":""},{"path":"gis.html","id":"other-spatial-data","chapter":"5 GIS","heading":"5.1.2 Other spatial data","text":"ESRI’s Living Atlas lot content, ’ve yet properly explore use (TODO).specific UK, spatial data ONS Ordnance Survey. notes accessing data chapter Public Data Sources Open Geography Portal OS Data Hub.","code":""},{"path":"gis.html","id":"web-maps-dashboards","chapter":"5 GIS","heading":"5.2 Web maps & dashboards","text":"","code":""},{"path":"gis.html","id":"arcgis","chapter":"5 GIS","heading":"5.2.1 ArcGIS","text":"Council’s Portal AGOL default home spatial data. Similarly, ’re looking just extract spatial data, share share spatial analysis via web map dashboard, default tool also Council’s Portal AGOL. share content Portal AGOL need Creator license.Anne Tetley provided following guidance (Portal) creating content Portal AGOL:Creating web map PortalCreating web map PortalCreating Web ApplicationCreating Web Application","code":""},{"path":"gis.html","id":"power-bi","chapter":"5 GIS","heading":"5.2.2 Power BI","text":"GIS capabilities Power BI match Portal AGOL. However, small proportion analysis sharing spatial, Power BI good option. ArcGIS Power BI integration tool available us. Anne Tetley provided following guidance (Portal):ArcGIS Power BI","code":""},{"path":"gis.html","id":"desktop-gis","chapter":"5 GIS","heading":"5.3 Desktop GIS","text":"specialised spatial analysis desktop GIS best. However, move sharing spatial information using web maps dashboards, rather static PDF maps, desktop GIS increasingly tool GIS specialists.","code":""},{"path":"gis.html","id":"arcgis-desktop","chapter":"5 GIS","heading":"5.3.1 ArcGIS Desktop","text":"last fifteen, twenty years, Council’s spatial analysis largely done using ArcGIS Desktop ESRI. powerful piece software, majority GIS uses, ’s sledge hammer crack nut. ’ve done spatial analysis , recommendation first try new, far intuitive, ArcGIS web GIS tools .e. Portal AGOL.ESRI stopped development ArcGIS Desktop, though won’t retired years yet. New functionality added ArcGIS Pro now .","code":""},{"path":"gis.html","id":"arcgis-pro","chapter":"5 GIS","heading":"5.3.2 ArcGIS Pro","text":"ArcGIS Pro another desktop GIS application ESRI. isn’t old ArcGIS Desktop, less legacy issues. ArcGIS Pro 64-bit closely integrated ArcGIS Enterprise (Portal) AGOL. However, single biggest difference hundreds nested menu driven options located different places ArcGIS Desktop!Council ArcGIS Pro license every purchased ArcGIS Desktop license.","code":""},{"path":"gis.html","id":"qgis","chapter":"5 GIS","heading":"5.3.3 QGIS","text":"QGIS open source alternative ArcGIS Desktop ArcGIS Pro.","code":""},{"path":"gis.html","id":"further-resources-2","chapter":"5 GIS","heading":"5.4 Further resources","text":"TODO - cross-ref database chapter spatial database content","code":""},{"path":"gis-with-python.html","id":"gis-with-python","chapter":"6 GIS with Python","heading":"6 GIS with Python","text":"Council’s ArcGIS software ESRI much stronger integration Python R, “GIS Python” chapter precedes “GIS R” chapter.three main ways leveraging GIS (particular Council’s ArcGIS) via Python. increasing order difficulty terms initial setup:ArcGIS Notebooks (see sub-heading immediately )ArcGIS Notebooks (see sub-heading immediately )Non-ESRI IDE e.g. Jupyter Notebooks, VS Code RStudioNon-ESRI IDE e.g. Jupyter Notebooks, VS Code RStudioR via reticulate packageR via reticulate packageArcGIS Notebooks take care Python environment ESRI license settings. Taking Python scripts outside ArcGIS Notebooks, e.g. using VS Code, means ’re taking responsibility Python environment ESRI license settings. Using Python R via reticulate package means added responsibility R environment.","code":""},{"path":"gis-with-python.html","id":"arcgis-notebooks","chapter":"6 GIS with Python","heading":"6.1 ArcGIS Notebooks","text":"ArcGIS Notebooks built top Jupyter Notebook, open-source web application allows create share documents contain live Python code, visualizations, narrative text.ArcGIS Notebooks can created ArcGIS Pro AGOL. also now available ArcGIS Enterprise yet setup Council’s Portal.Learn Python ArcGIS NotebooksNotebooks ArcGIS Pro documentationArcGIS API Python Fundamentals learning plan","code":""},{"path":"gis-with-python.html","id":"arcgis-python-api","chapter":"6 GIS with Python","heading":"6.2 ArcGIS Python API","text":"arcgis package used work ArcGIS Enterprise (Portal) AGOL.- name package ’s purpose - OneNote?use arcpy arcgis packages first need specify ArcGIS Python environment","code":""},{"path":"gis-with-python.html","id":"arcpy","chapter":"6 GIS with Python","heading":"6.3 ArcPy","text":"arcpy package used leverage ArcGIS Desktop Pro functionality. Like arcgis package, use arcpy package first need specify ArcGIS Python environment.distinction web desktop, arcgis arcpy packages respectively, bit simplification serves purpose. ’s worth noting integration two packages isn’t seamless might expect.TODO- setup- cross ref Docker","code":""},{"path":"gis-with-python.html","id":"non-esri-gis-with-python","chapter":"6 GIS with Python","heading":"6.4 Non-ESRI GIS with Python","text":"","code":""},{"path":"gis-with-r.html","id":"gis-with-r","chapter":"7 GIS with R","heading":"7 GIS with R","text":"rule thumb, use GIS R ’re familiar R ArcGIS Python, project just spatial content. project predominantly spatial, consider upskilling ArcGIS. GIS capabilities R packages increasingly competent. However, ’ll swimming tide don’t take advantage Council’s investment ArcGIS platform, tools skills.chapter focusses can include spatial data R project public data sources Council’s ArcGIS platform.","code":""},{"path":"gis-with-r.html","id":"features","chapter":"7 GIS with R","heading":"7.1 Features","text":"term “feature” useful distinguish record “spatial”. “spatial” mean point, line polygon. point pair coordinates, line minimum two pairs coordinates polygons least three pairs.Something keep eye MULTIPOINT, multi-part polygons etc. single record, single feature, one point, line polygon. example, Sheffield secondary school features might MULTIPOINT feature King Edward VII school can one point Lower School near Crosspool, another point Upper School Broomhill.","code":""},{"path":"gis-with-r.html","id":"simple-features","chapter":"7 GIS with R","heading":"7.1.1 Simple features","text":"Simple features open standard developed Open Geospatial Consortium. hierarchical data model represents wide range geometry types, supported sf R package. sf package also plays nice tidyverse.","code":"\n# Create a data frame with some example records \ndf <- tibble::tribble(\n  ~name,    ~postcode, ~longitude,  ~latitude,\n  \"SCC\",    \"S1 2HH\",    -1.470006,   53.38038,\n  \"Blades\", \"S2 4SU\",  -1.470512,   53.36986,\n  \"Owls\",   \"S6 1SW\",    -1.500859,   53.41084\n)\n\n# Create simple features\nsf_shef <- sf::st_as_sf(df, \n                        coords = c(\"longitude\", \"latitude\"), #from postcodes.io\n                        crs = 4326) #WSG84\n\n# Plot\nmapview::mapview(sf_shef, layer.name = \"Sheffield institutions\")"},{"path":"gis-with-r.html","id":"coordinates-projections","chapter":"7 GIS with R","heading":"7.2 Coordinates & projections","text":"minimum need know spatial data use likely involve one three coordinate systems:WSG84 ESPG 4326Web Mercator EPSG 3857OSGB1936 (British National Grid) ESPG 27700Most web maps based features stored WSG84 displayed (projected) Web Mercator. Postcodes.io uses WSG84, Council’s Portal AGOL, ONS Open Geography Portal use OSGB1936 (BNG).","code":"\n# Check the coordinate system of simple features\nsf::st_crs(sf_shef)## Coordinate Reference System:\n##   User input: EPSG:4326 \n##   wkt:\n## GEOGCRS[\"WGS 84\",\n##     DATUM[\"World Geodetic System 1984\",\n##         ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n##             LENGTHUNIT[\"metre\",1]]],\n##     PRIMEM[\"Greenwich\",0,\n##         ANGLEUNIT[\"degree\",0.0174532925199433]],\n##     CS[ellipsoidal,2],\n##         AXIS[\"geodetic latitude (Lat)\",north,\n##             ORDER[1],\n##             ANGLEUNIT[\"degree\",0.0174532925199433]],\n##         AXIS[\"geodetic longitude (Lon)\",east,\n##             ORDER[2],\n##             ANGLEUNIT[\"degree\",0.0174532925199433]],\n##     USAGE[\n##         SCOPE[\"Horizontal component of 3D system.\"],\n##         AREA[\"World.\"],\n##         BBOX[-90,-180,90,180]],\n##     ID[\"EPSG\",4326]]"},{"path":"gis-with-r.html","id":"geographic-projected-coordinate-systems","chapter":"7 GIS with R","heading":"7.2.1 Geographic & projected coordinate systems","text":"reference ellipsoid approximation surface earth provides shape coordinate system can placed.Geographic coordinate systems use ellipsoid define specific locations surface create grid. Datums geographic coordinate systems based specific ellipsoid (specific geographic coordinate system), origin specific location, ellipsoid specific orientation. also called “spatial reference systems” “coordinate reference systems”.Projected coordinate systems like geographic coordinate systems. projected coordinate system also grid used reference locations planet, ’s translation three-dimensional grid onto two-dimensional plane paper map screen.GCS defines data located earth’s surface. PCS tells data draw flat surface screen.Coordinate systems, projected geographic, often identified EPSG code.","code":""},{"path":"gis-with-r.html","id":"arcgisr","chapter":"7 GIS with R","heading":"7.3 ArcGIS R & Python packages","text":"Listed R Python packages allow us leverage ArcGIS functionality. Generally speaking, descending order ease use, scope functionality ascending order.","code":""},{"path":"gis-with-r.html","id":"esri2sf","chapter":"7 GIS with R","heading":"7.3.1 esri2sf","text":"esri2sf R package one four packages listed maintained ESRI. simplest start using doesn’t require installation license ArcGIS Desktop Pro. flip side, least amount functionality code isn’t robust. scope package limited reading simple features data frames AGOL & ArcGIS Enterprise (organisation’s).ONS Open Geography Portal based ArcGIS web tools Portal AGOL. get, example, local authority boundary Sheffield first need navigate dataset website get GeoService API URL:, using:copied GeoService URL,\n\nhttps://services1.arcgis.com/ESMARspQHYMw9BZ9/arcgis/rest/services/Local_Authority_Districts_December_2020_UK_BGC/FeatureServer/0/query?outFields=\\\\\\\\\\\\\\*&=1%3D1\ncopied GeoService URL,https://services1.arcgis.com/ESMARspQHYMw9BZ9/arcgis/rest/services/Local_Authority_Districts_December_2020_UK_BGC/FeatureServer/0/query?outFields=\\\\\\\\\\\\\\*&=1%3D1some resources understand query API,\n\nArcGIS REST API - Query (Feature Service/Layer)\nSQL 92 used ESRI based APIs\nHTML encoding used building URL queries\nresources understand query API,ArcGIS REST API - Query (Feature Service/Layer)SQL 92 used ESRI based APIsHTML encoding used building URL queriesand esri2sf,esri2sf,can get Sheffield boundary simple feature:example reads open data. However, Council’s spatial data Portal AGOL requires login credentials access. Nevertheless, Portal AGOL login credentials smaller requirement ArcGIS Desktop Pro installation license.TODO - test note authentication tokenOur public github.com/scc-pi/functions repository includes functions ShefAreas.R use esri2sf. sub-headings immediately outline ArcGIS packages powerful, also onerous terms licensing setup. possible, intention utilise esri2sf preference ArcGIS packages.Relying esri2sf may require contributions esri2sf repository. example, pull request fix assumption least 500 features can served time, ONS Open Geography Portal limit 50 (hence forked github.com/scc-pi/esri2sf repository). Contributing esri2sf repository preferable accessing Portal AGOL API via Javascript, better suited web developers data analysts.information esri2sf package, install use , available github.com/yonghah/esri2sf.","code":"\n# Base URL for ONS Open Geography Portal\nons_geog_base_url <- \"https://services1.arcgis.com/ESMARspQHYMw9BZ9/arcgis/rest/services/\"\n\n# URL part for how detailed the local authority boundary should be\ngeneralised <- \"Local_Authority_Districts_December_2020_UK_BGC\"\n\n# Get Sheffield MSOA boundaries as simple features  \nshef_msoa <- esri2sf::esri2sf(url = stringr::str_c(ons_geog_base_url,\n                                                   generalised,\n                                                   \"/FeatureServer/0\"),\n                              where = \"LAD20NM LIKE 'Sheffield%'\",\n                              geomType = \"esriGeometryPolygon\")\n\n# Plot\nmapview::mapview(shef_msoa, layer.name = \"Sheffield\")"},{"path":"gis-with-r.html","id":"r-arcgis-bridge","chapter":"7 GIS with R","heading":"7.3.2 R-ArcGIS Bridge","text":"R-ArcGIS Bridge name arcgisbinding R package. ’s scope limited :Transferring data directions ArcGIS RTransferring data directions ArcGIS RWrapping R tools use ArcGISWrapping R tools use ArcGISFor information using arcgisbinding package see vignette Using R-ArcGIS Bridge.use R-ArcGIS Bridge need installation license ArcGIS Desktop Pro. loading arcgisbinding package call arc.check_product() define desktop license:Using arcgisbinding ArcGIS Desktop means need use 32-bit R, ArcGIS Desktop 32-bit. ArcGIS Desktop 64-bit Background Geoprocessing option red herring allows using bridge ArcGIS, within R . ArcGIS Pro 64-bit allows use use 64-bit R arcgisbinding.README.md r-bridge GitHub repository best starting point detail R-ArcGIS Bridge requirements installation.R-ArcGIS Bridge write spatial data directly Council’s Portal AGOL. can write local geodatabase, can published Portal AGOL via ArcGIS Pro. R-ArcGIS Bridge can read spatial data directly Council’s Portal AGOL:arc.check_product() define desktop license means results example can’t rendered via GitHub Actions notes. However, example knitted locally included notes isochrones.","code":"\nlibrary(arcgisbinding)\narc.check_product()"},{"path":"gis-with-r.html","id":"leaflet","chapter":"7 GIS with R","heading":"7.4 Leaflet","text":"TODO","code":""},{"path":"gis-with-r.html","id":"rasters","chapter":"7 GIS with R","heading":"7.5 Rasters","text":"TODO","code":""},{"path":"gis-with-r.html","id":"further-resources-3","chapter":"7 GIS with R","heading":"7.6 Further resources","text":"Geocomputation R, Robin Lovelacemapview basics vignetteGeographic vs Projected Coordinate Systems, Heather Smith, ArcGIS Blog (27 February 2020)EPSG 4326 vs EPSG 3857, Lyzi Diamond (26 May 2017)","code":""},{"path":"geocoding.html","id":"geocoding","chapter":"8 Postcodes & Addresses","heading":"8 Postcodes & Addresses","text":"common use case work spatial analysis dataset addresses. example, produce map certain incidents last year, summarise number incidents Ward.","code":""},{"path":"geocoding.html","id":"uprn","chapter":"8 Postcodes & Addresses","heading":"8.1 UPRN","text":"TODO","code":""},{"path":"geocoding.html","id":"postcodes","chapter":"8 Postcodes & Addresses","heading":"8.2 Postcodes","text":"’s UPRN, getting location via postcode usually easiest option. ’s accurate UPRN full address, often ’s accurate enough ’s required.example using add_pcd_vars() function builds PostcodesioR package, wrapper postcodes.io API. pass data frame postcode column returns data frame new columns based postcode.admin_district can used answer questions: postcode invalid? postcode Sheffield? can anticipate values NA Sheffield respectively answers yes. common questions function .admin_district argument.Needing coordinates postcode centroid also common, function also .lat_long argument TRUE returns latitude column longitude column.TODO: link sf example & area statsOther columns added including name character vector passed other_vars function argument. example, other_vars=c(\"ccg_code\",\"lsoa_code\"). list valid other_vars defined docs.ropensci.org/PostcodesioR/#examples.pcd_name function argument used specify name data frame’s postcode column isn’t postcode. example, pcd_name=\"pupil_pcode\".Sometimes, postcode dataset included separate column, end combined address column. Depending format quality combined address column extract postcode like :","code":"\n# Create a data frame with some example records\ndf <- tibble::tribble(\n  ~name,    ~postcode,\n  \"SCC\",    \"S1 2HH\",\n  \"Blades\", \"S2 4SU\",\n  \"Owls\",   \"S6 1SW\"\n)\n\n# Load the function we need\nsource(\"https://raw.githubusercontent.com/scc-pi/functions/main/Addresses.R\")\n\n# Add postcode related columns to our data frame\nadd_pcd_vars(df,\n             pcd_name = \"postcode\",\n             .admin_district = FALSE,\n             .lat_long = TRUE,\n             other_vars = c(\"admin_ward\",\n                            \"msoa_code\")) %>%\n  knitr::kable() #display them in a nice table\n# Create a data frame with some example records\ndf <- tibble::tribble(\n  ~name,     ~address,\n  \"SCC\",     \"Pinstone St, Sheffield City Centre, Sheffield S1 2HH\",\n  \"Blades\",  \"Bramall Ln, Highfield, Sheffield S2 4SU\",\n  \"Owls\",    \"76 Penistone Rd N, Sheffield S6 1SW\"\n)\n\n# Extract the postcode from the address into a separate column\ndplyr::mutate(df, \n              postcode = stringr::word(address, -2, -1, sep = \"[:space:]\")) %>%\n  knitr::kable()"},{"path":"geocoding.html","id":"pas-postcode-lookup","chapter":"8 Postcodes & Addresses","heading":"8.2.1 PAS Postcode Lookup","text":"PAS, Performance & Analysis Service People Porfolio, maintains postcode lookup table performs role add_pcd_vars() function.TODO: also include Sheffield specific variables e.g. 100 neighbourhoods postcode ?","code":""},{"path":"geocoding.html","id":"postcode-boundaries","chapter":"8 Postcodes & Addresses","heading":"8.2.2 Postcode Boundaries","text":"TODO: OPEN DATA GB POSTCODE UNIT BOUNDARIES","code":""},{"path":"geocoding.html","id":"split-postcodes","chapter":"8 Postcodes & Addresses","heading":"8.2.3 Split postcodes","text":"TODO","code":""},{"path":"geocoding.html","id":"addresses","chapter":"8 Postcodes & Addresses","heading":"8.3 Addresses","text":"Anne Tetley provided following guidance (Portal):Geocoding Address Data PortalTODO\n- Portal LLPG Cascade Locator\n- OS Places ESRI integration","code":""},{"path":"public-data.html","id":"public-data","chapter":"9 Public Data Sources","heading":"9 Public Data Sources","text":"","code":""},{"path":"public-data.html","id":"office-of-national-statistics","chapter":"9 Public Data Sources","heading":"9.1 Office of National Statistics","text":"example ’re going get population Ward Sheffield. First need find dataset ONS website. copy link Excel file use script :monstR onsr R packages provide access ONS beta API. However, API currently quite limited number datasets, particular lacks access data smaller geographies ’re typically interested e.g. wards LSOAs.","code":""},{"path":"public-data.html","id":"crm","chapter":"9 Public Data Sources","heading":"9.1.1 CRM","text":"TODO","code":""},{"path":"public-data.html","id":"nomis","chapter":"9 Public Data Sources","heading":"9.1.2 NOMIS","text":"TODO","code":""},{"path":"public-data.html","id":"open-geography","chapter":"9 Public Data Sources","heading":"9.1.3 Open Geography Portal","text":"TODO","code":""},{"path":"public-data.html","id":"ministry-of-housing-communities-local-government","chapter":"9 Public Data Sources","heading":"9.2 Ministry of Housing, Communities & Local Government","text":"Official statistics MHCLG (Ministry Housing, Communities & Local Government):opendatacommunities.orgguides.opendatacommunities.org/article/19-apis-part-2-using-r---apis","code":""},{"path":"public-data.html","id":"ordnance-survey","chapter":"9 Public Data Sources","heading":"9.3 Ordnance Survey","text":"TODO","code":""},{"path":"public-data.html","id":"os-data-hub","chapter":"9 Public Data Sources","heading":"9.3.1 OS Data Hub","text":"TODO","code":""},{"path":"public-data.html","id":"lginform","chapter":"9 Public Data Sources","heading":"9.4 LGInform?","text":"","code":""},{"path":"public-data.html","id":"lsoapop-r-package","chapter":"9 Public Data Sources","heading":"9.5 LSOApop R package","text":"goal LSOApop make population estimates Lower layer Super Output Areas (LSOA) Indecies Multiple Deprivation (IMD) easily available R.nhs-r-community.github.io/LSOApop","code":""},{"path":"databases.html","id":"databases","chapter":"10 Databases","heading":"10 Databases","text":"","code":""},{"path":"databases.html","id":"corporate-data-warehouse","chapter":"10 Databases","heading":"10.1 Corporate data warehouse","text":"","code":""},{"path":"databases.html","id":"oscar","chapter":"10 Databases","heading":"10.1.1 OSCAR","text":"TODO","code":""},{"path":"databases.html","id":"corporate-spatial-database","chapter":"10 Databases","heading":"10.2 Corporate spatial database","text":"TODO\n- Postgres - extensions geometry types e.g. line","code":""},{"path":"databases.html","id":"sqlite","chapter":"10 Databases","heading":"10.3 SQLite","text":"Access SQLite database controlled permissions folder stored. Unlike databases, create users authenticated database, grant privileges specific datasets users.SQLite also different databases fields assigned specific data types data type definitions strictly enforced. Instead, SQLite uses storage classes values different data types can stored. particular, date types handled differently. ArcGIS handles SQLite dates without needing special attention, reading dates SQLite R Power BI needs attention. example, using JD() function insol package:","code":"\n# Convert dates we've read from a SQLite database\nmutate(date = JD(date, inverse = TRUE),\n       week_end = JD(week_end, inverse = TRUE))"},{"path":"databases.html","id":"spatialite","chapter":"10 Databases","heading":"10.3.1 SpatiaLite","text":"SpatiaLite extends SQLite support spatial data. RSQLite package includes driver SpatiaLite.Robin Lovelace chapter spatial databases book Geocomputation R.testing different options, SpatiaLite best file based database access spatial data via tools R Power BI without complication ArcGIS licenses, also provides reliable access ArcGIS. far ’ve tested SpatiaLite databases created ArcGIS","code":""},{"path":"databases.html","id":"further-resources-4","chapter":"10 Databases","heading":"10.4 Further resources","text":"Databases using R RStudio","code":""},{"path":"other.html","id":"other","chapter":"11 Other","heading":"11 Other","text":"dumping ground matters ’m yet look properly, never mind write notes .","code":""},{"path":"other.html","id":"renv","chapter":"11 Other","heading":"11.1 renv","text":"Introduction renv vignette","code":""},{"path":"other.html","id":"docker","chapter":"11 Other","heading":"11.2 Docker","text":"Using docker containers means don’t deal “works machine” problems.Currently, set-reproducibility issues ’ve arcpy Jupyter notebooks means can’t recommend others Council go path therefore collaborate tools. Docker means address issues, least, allow officers trial arcpy Jupyter notebooks investing complicated setup? typical R projects renv might preferable.Docker Data Science — Step Step Guide, Dean Pleban (18 October 2020)Pros Cons Docker, Nick Iron.io (28 August 2020)Play Dockerrocker R package","code":""},{"path":"other.html","id":"reprex-r-package","chapter":"11 Other","heading":"11.3 reprex R package","text":"reprex.tidyverse.org","code":""},{"path":"other.html","id":"writing-r-packages","chapter":"11 Other","heading":"11.4 Writing R packages","text":"R Packages Hadley Wickham & Jenny Bryan","code":""},{"path":"other.html","id":"roxygen2","chapter":"11 Other","heading":"11.4.1 roxygen2","text":"Introduction roxygen2 vignette10.3 Roxygen comments","code":""},{"path":"other.html","id":"plumber-r-package","chapter":"11 Other","heading":"11.5 plumber R package","text":"rplumber.io","code":""},{"path":"other.html","id":"data-visualisation","chapter":"11 Other","heading":"11.6 Data Visualisation","text":"Data Visualization, practical introduction Kieran Healygrammer graphics, R4DS, Graphics cookbook, stackexchange","code":""},{"path":"references.html","id":"references","chapter":"References","heading":"References","text":"","code":""}]
