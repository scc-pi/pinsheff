# (PART) Scripting {.unnumbered}

# Why script?

## What is scripting? 

Scripts are a series of typed commands in a file. When you "run" a script, you are asking a programme to interpret and fulfil the commands in the script to accomplish a given task. 

The terms "scripting", "coding" and "programming" are often used synonymously. More accurately though, coding and programming are umbrella terms that scripting is just a part of. Compared with coding and programming, scripting generally covers less complex tasks, with an easier to understand language, and with fewer commands.

## Scripting for data analysis 

Scripts can be used to accomplish a variety of tasks. For example, BCIS in Sheffield City Council use scripts to update and maintain laptops and servers.  

For the purposes of these notes, we are limiting the scope of scripting to mean scripting for data analysis. So, scripting to accomplish data analysis tasks, including data:  

* extraction  

* transformation  

* loading  

* exploration  

* analysis  

* modelling 

* visualisation  

* narration  

Scripting for data capture, data entry, is outside the scope of these notes.

## Scripting pros & cons? 

There's an element of self-documentation with scripting, so it's easier to return to a scripted task after a bit of time away from it, or pick up a scripted task from a colleague. However, in-line comments and adherence to a style guide make a big difference to just how easy it is. Version control and collaboration are also easier with scripting than GUI tools.

Scripting is not always better than using GUI tools. There's a good reason that more people use Mac OS and Windows than Unix Bash. Scripting or GUI tools is a horses for courses question, and some GUI workflow tools that the Council has licenses for (e.g. FME, Simul8 and ModelBuilder in ArcGIS) sit somewhere in the middle.

RStudio makes the (slightly biased?) case for scripting in an hour long webinar on [Why Your Enterprise Needs Code-First Data Science](https://www.rstudio.com/resources/why-your-enterprise-needs-code-first-data-science/)

## Scripting languages  

### R & Python  

Python and R are open-source scripting languages popular with data analysts. Python is a general-purpose language with an easy-to-understand syntax. R's functionality was developed with statisticians in mind and is popular in academia and research.

#### Notebooks  

*Jupyter & R Markdown notebooks*

### SQL

SQL (Structured Query Language) is designed for storing, manipulating and retrieving data in a database. SQL commands are simpler and their range narrower than R and Python commands. For example, time series or spatial analysis isn't within scope of SQL. Also, whilst much of our data is still held in databases, data is now commonly from CSV files and other formats. 

SQL is run on the database server, which even with today's powerful personal computers, can have time saving benefits. The type of database can mean the SQL extensions have different syntax, but the core elements such as `SELECT` and `JOIN` are generic.     

Often it's not a case of choosing to use SQL or say R, but using both. SQL to initially extract data from a corporate database. Then R to combine with data from other sources, e.g. ONS, and then analyse and visualise it. 
### VBA

VBA (Visual Basic for Applications) is Microsoft's scripting language for, and built into, its Office programmes like Word and PowerPoint. However, for data analysis purposes, it is how it extends and automates Excel that is of interest.     

### Others 


DAX
Typescript
Javascript
Arcade
Stata, SPSS?

## Who writes scripts?  

This isn't an exhaustive list of who in the Council writes scripts. Rather, it is a few examples that illustrate why different people use scripts.  

**Laurie Platt** (BI Team) used to develop software before working as a Town Planner. His experience with coding rather than Excel meant scripting was a more obvious tool for him. Laurie initially started scripting whilst a Planner, using Python to **automate** some spatial analysis tasks. However, he found **reproducibility** to be the main advantage of scripting. Iterating, improving a process incrementally and at the end verifying the results by re-running the script.

**Dan Taylor** (BI Team) - *Excel, R, Python, version control*

**Giles Robinson** (BI Team) - *SQL, DAX, R, collaboration*  

**Ben Arnold** (Performance Team) - *VBA, DAX*  

**Martin Fox** (Capital Delivery Service) - *Javascript* 

