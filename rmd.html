<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 3 R Markdown | Notes</title>
<meta name="author" content="Laurie Platt">
<meta name="description" content="3.1 R Markdown vs Markdown Markdown is a markup language for creating formatted text using a plain-text editor. Its main aim is readability, for it to have simple, unobtrusive syntax and be...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 3 R Markdown | Notes">
<meta property="og:type" content="book">
<meta property="og:description" content="3.1 R Markdown vs Markdown Markdown is a markup language for creating formatted text using a plain-text editor. Its main aim is readability, for it to have simple, unobtrusive syntax and be...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 3 R Markdown | Notes">
<meta name="twitter:description" content="3.1 R Markdown vs Markdown Markdown is a markup language for creating formatted text using a plain-text editor. Its main aim is readability, for it to have simple, unobtrusive syntax and be...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="libs/leaflet-1.3.1/leaflet.js"></script><link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="libs/proj4-2.6.2/proj4.min.js"></script><script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script><script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script><script src="libs/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script><link href="libs/HomeButton-0.0.1/home-button.css" rel="stylesheet">
<script src="libs/HomeButton-0.0.1/home-button.js"></script><script src="libs/HomeButton-0.0.1/easy-button-src.min.js"></script><script src="libs/clipboard-0.0.1/setClipboardText.js"></script><link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet">
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Notes</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li class="book-part">Scripting tools</li>
<li><a class="" href="github.html"><span class="header-section-number">1</span> Version control &amp; GitHub</a></li>
<li><a class="" href="r.html"><span class="header-section-number">2</span> R &amp; RStudio</a></li>
<li><a class="active" href="rmd.html"><span class="header-section-number">3</span> R Markdown</a></li>
<li><a class="" href="python.html"><span class="header-section-number">4</span> Python</a></li>
<li class="book-part">Accessing data</li>
<li><a class="" href="databases.html"><span class="header-section-number">5</span> Council data</a></li>
<li><a class="" href="warehouse.html"><span class="header-section-number">6</span> Databases, warehouses &amp; lakes</a></li>
<li><a class="" href="api.html"><span class="header-section-number">7</span> APIs</a></li>
<li><a class="" href="public-data.html"><span class="header-section-number">8</span> External data sources</a></li>
<li class="book-part">Spatial data</li>
<li><a class="" href="spatial-data-sources.html"><span class="header-section-number">9</span> Spatial data sources</a></li>
<li><a class="" href="gis-with-web-desktop-tools.html"><span class="header-section-number">10</span> GIS with web &amp; desktop tools</a></li>
<li><a class="" href="gis-with-python.html"><span class="header-section-number">11</span> GIS with Python</a></li>
<li><a class="" href="gis-with-r.html"><span class="header-section-number">12</span> GIS with R</a></li>
<li><a class="" href="geocoding.html"><span class="header-section-number">13</span> Postcodes &amp; addresses</a></li>
<li class="book-part">ETL</li>
<li class="book-part">Statistical modelling</li>
<li class="book-part">Visualisation</li>
<li class="book-part">Appendix</li>
<li><a class="" href="other.html"><span class="header-section-number">14</span> Other</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/scc-pi/notes">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="rmd" class="section level1">
<h1>
<span class="header-section-number">3</span> R Markdown<a class="anchor" aria-label="anchor" href="#rmd"><i class="fas fa-link"></i></a>
</h1>
<div id="r-markdown-vs-markdown" class="section level2">
<h2>
<span class="header-section-number">3.1</span> R Markdown vs Markdown<a class="anchor" aria-label="anchor" href="#r-markdown-vs-markdown"><i class="fas fa-link"></i></a>
</h2>
<p>Markdown is a markup language for creating formatted text using a plain-text editor. Its main aim is readability, for it to have simple, unobtrusive syntax and be readable as-is, unlike text formatted with a markup language such as RTF or HTML. A raw markdown document should be easy to read, as well as the final rendered output.</p>
<p>GitHub has it’s own flavour of markdown, most commonly used in the <code>README.md</code> file that serves to introduce each GitHub repository.</p>
<p>R Markdown is another flavour of markdown. It combines in a reproducible manner: code, output, and commentary. R Markdown documents support different output formats, like PDFs, Word files, slideshows, and HTML. Hadley Wickham <a href="https://r4ds.had.co.nz/r-markdown.html#introduction-18">lists</a> the three main uses of R Markdown files as:</p>
<ol style="list-style-type: decimal">
<li><p>For communicating to decision makers, who want to focus on the conclusions, not the code behind the analysis.</p></li>
<li><p>For collaborating with other data scientists (including future you!), who are interested in both your conclusions, and how you reached them (i.e. the code).</p></li>
<li><p>As an environment in which to <em>do</em> data science, as a modern day lab notebook where you can capture not only what you did, but also what you were thinking.</p></li>
</ol>
<p>My experience of R Markdown is very positive. It’s really helpful for keeping all my work in a single place, rather than wondering whether notes are in script comments, OneNote or a Word document. Similarly the output is embedded rather than relying on well organised data output folder structures. Finally, the linear nature of a document also provides some structure. Combining R Markdown with GitHub provides version control (an audit trail or log of how the work has evolved), plus GitHub Issues and Actions can add to the project management wrapper around the work.</p>
</div>
<div id="r-markdown-security-data-protection" class="section level2">
<h2>
<span class="header-section-number">3.2</span> <strong>R Markdown security &amp; data protection</strong><a class="anchor" aria-label="anchor" href="#r-markdown-security-data-protection"><i class="fas fa-link"></i></a>
</h2>
<p>A limit of R Markdown, or rather our current unapproved use of GitHub, is that a repo for a project with PID or other confidential data must exclude the rendered output of the R Markdown file. The <code>.Rmd</code> file is fine to be included in the GitHub repo, but the rendered output e.g. <code>.pdf</code> or <code>.html</code>, which includes the output of code and probably some of your confidential data, needs to be excluded from the GitHub repo, even if your repo is private. I’m not clear yet what the implications of this are for collaborating with R Markdown e.g. with an R Notebook, but I’d be interested to hear. The limitation does make sharing the R Markdown rendered output cumbersome, especially this side of the Council’s <em>always on VPN</em>, SharePoint upgrade and pending a fuller roll-out of MS Teams functionality. Ultimately though, if GitHub proves useful, we need to make the case for a paid, fuller functioned and more secure Council instance. See the section on <a href="github.html#github-security">GitHub security &amp; data protection</a> for more detail about this, and in particular how to use <code>.gitignore</code> to exclude the rendered R Markdown output from your GitHub repo.</p>
</div>
<div id="r-notebooks" class="section level2">
<h2>
<span class="header-section-number">3.3</span> R Notebooks<a class="anchor" aria-label="anchor" href="#r-notebooks"><i class="fas fa-link"></i></a>
</h2>
<p><em>TODO - technical vs data exploration - don’t add to github</em></p>
</div>
<div id="bookdown" class="section level2">
<h2>
<span class="header-section-number">3.4</span> Bookdown<a class="anchor" aria-label="anchor" href="#bookdown"><i class="fas fa-link"></i></a>
</h2>
<p>These notes are written using the <a href="https://pkgs.rstudio.com/bookdown/">bookdown package</a>, which is built on top of R Markdown and <a href="https://yihui.org/knitr/">knitr</a>.</p>
<p>Each Rmd file contains one and only one chapter, and a chapter is defined by the first-level heading <code>#</code>.</p>
<div id="themes" class="section level3">
<h3>
<span class="header-section-number">3.4.1</span> Themes<a class="anchor" aria-label="anchor" href="#themes"><i class="fas fa-link"></i></a>
</h3>
<p>The theme of these notes changed in September 2021 from a <a href="https://bookdown.org/yihui/bookdown/html.html#gitbook-style">GitBook style</a> to a <a href="https://bookdown.org/yihui/bookdown/html.html#bs4-book">Three-column Bootstrap style</a>.</p>
</div>
<div id="publishing" class="section level3">
<h3>
<span class="header-section-number">3.4.2</span> Publishing<a class="anchor" aria-label="anchor" href="#publishing"><i class="fas fa-link"></i></a>
</h3>
<p>These notes are published on <a href="https://pages.github.com/">GitHub Pages</a> with <a href="https://github.com/features/actions">GitHub Actions</a>. A GitHub Action has been configured to start when there’s a push to the <a href="https://github.com/scc-pi/notes">master branch</a>. The Action renders the Rmd files in the master branch to HTML and then deploys the HTML files as a static website to a branch called <code>gh-pages</code>. Alternatives to using GitHub Actions include Travis and Jekyll.</p>
<p>I used the steps outlined in the following blog post: <a href="https://medium.com/@delucmat/how-to-publish-bookdown-projects-with-github-actions-on-github-pages-6e6aecc7331e">How to publish bookdown projects with GitHub Actions on GitHub Pages</a>. However, I did a lot of the git bash commands manually and there were a couple of fixes I made to the <code>deploy_bookdown.yaml</code> file:</p>
<p>1. Under …</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb8-1"><a href="rmd.html#cb8-1"></a><span class="fu">uses</span><span class="kw">:</span><span class="at"> Cecilapp/GitHub-Pages-deploy@master</span></span></code></pre></div>
<p>… I added …</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb9-1"><a href="rmd.html#cb9-1"></a><span class="fu">with</span><span class="kw">:</span><span class="at">       </span></span>
<span id="cb9-2"><a href="rmd.html#cb9-2"></a><span class="at">  </span><span class="fu">build_dir</span><span class="kw">:</span><span class="at"> _book/       </span></span>
<span id="cb9-3"><a href="rmd.html#cb9-3"></a><span class="at">  </span><span class="fu">email</span><span class="kw">:</span><span class="at"> ${{ secrets.EMAIL }}</span></span></code></pre></div>
<p>2. I used <code>GITHUB_TOKEN</code> rather than <code>GH_PAT</code>, as per a change to <a href="https://github.com/Cecilapp/GitHub-Pages-deploy#news">GitHub-Pages-deploy</a>.</p>
</div>
</div>
<div id="flexdashboard" class="section level2">
<h2>
<span class="header-section-number">3.5</span> Flexdashboard<a class="anchor" aria-label="anchor" href="#flexdashboard"><i class="fas fa-link"></i></a>
</h2>
<blockquote>
<p>The goal of flexdashboard is to make it easy to create interactive dashboards for R, using R Markdown.</p>
</blockquote>
<p><a href="https://pkgs.rstudio.com/flexdashboard/">pkgs.rstudio.com/flexdashboard</a></p>
<p>Flexdashboards don’t have the same functionality of Power BI, nor do they allow data input like Shiny. However, they are very simple and quick to create. They can be a good option if the dashboard is unlikely to be maintained beyond a specific project. The flexdashboard output is simply an HTML file, so it’s useful if you need to share the dashboard with a few people outside the organisation. They’re also obviously a good option if you’ve done your data analysis and preparatory work in R. The Council’s imminent upgrade of SharePoint and to fuller MS Teams functionality, could be a really useful way to publish flexdashboards.</p>
<p><em>TODO: Test whether a fexdashboard can be hosted via our Power BI Report Server in an IFrame.</em></p>
</div>
<div id="rolldown" class="section level2">
<h2>
<span class="header-section-number">3.6</span> Rolldown<a class="anchor" aria-label="anchor" href="#rolldown"><i class="fas fa-link"></i></a>
</h2>
<blockquote>
<p><a href="https://github.com/yihui/rolldown/blob/master/README.md">Rolldown</a> is an R Markdown extension that builds scroll-driven HTML documents for storytelling, a.k.a scrollytelling.</p>
</blockquote>
<p>It’s similar to the ArcGIS StoryMaps that have proved popular and people might be familiar with.</p>
</div>
<div id="child-r-markdown" class="section level2">
<h2>
<span class="header-section-number">3.7</span> Child R Markdown<a class="anchor" aria-label="anchor" href="#child-r-markdown"><i class="fas fa-link"></i></a>
</h2>
<p>Here are a couple of use cases for child R Markdown documents:</p>
<ol style="list-style-type: decimal">
<li><p>Your content is so large that breaking it down into smaller parts makes it more manageable.</p></li>
<li><p>You want to include the same child R Markdown document in more than one parent document. For example the <a href="https://github.com/scc-pi/libraries">libraries repo</a> uses a child R Markdown document in a <a href="https://github.com/scc-pi/libraries/blob/main/ClusterExample.Rmd">standalone example</a> and in a much <a href="https://github.com/scc-pi/libraries/blob/main/LibrariesScheduling-BI-Report-14May2021.Rmd">larger project documentation document</a>.</p></li>
</ol>
<script src="https://gist.github.com/laurie-platt/d4323e68c28ee6bf1e6880153416b5d1.js"></script><p>Note that a child R Markdown has no YAML header, it just inherits its parent’s YAML header.</p>
<div id="iteration" class="section level3">
<h3>
<span class="header-section-number">3.7.1</span> Iteration<a class="anchor" aria-label="anchor" href="#iteration"><i class="fas fa-link"></i></a>
</h3>
<p>A third and more complicated use case for child R Markdown, is to use a parameter to iterate through a child R Markdown document. You still have a single <code>parent.Rmd</code> and a single <code>child.Rmd</code> file. However, in the single knitted output file, you have <code>n</code> iterations of the child document content depending on the number of values in the parameter. There’s a proof-of-concept <a href="https://github.com/scc-pi/C19Surveillance/tree/master/r-markdown/UosExample">example</a> in the C19Surveillance repo. Three different residential types are passed as a parameter to the child R Markdown document, which renders a map and a summary table for each residential type in the knitted output:</p>
<script src="https://gist.github.com/laurie-platt/79a5e9cd3b08820b781e38cc0996fec2.js"></script><p>This iteration technique isn’t prominent because the demand for such reports outside the Council has largely been superseded by browser based dashboards, such as those provided via Power BI or Shiny. However, the Council hasn’t fully transitioned from static reports (e.g. pdf files) to browser based dashboards. Until it has, there may still be an expectation, a demand, for such iterative reports.</p>
</div>
</div>
<div id="r-markdown-tips" class="section level2">
<h2>
<span class="header-section-number">3.8</span> R Markdown tips<a class="anchor" aria-label="anchor" href="#r-markdown-tips"><i class="fas fa-link"></i></a>
</h2>
<div id="markdown-visual-editor" class="section level3">
<h3>
<span class="header-section-number">3.8.1</span> Markdown visual editor<a class="anchor" aria-label="anchor" href="#markdown-visual-editor"><i class="fas fa-link"></i></a>
</h3>
<p>The RStudio v1.4 release includes a visual editor for markdown, which makes it more like using MS Word:</p>
<div class="inline-figure"><img src="images/rmd-editor.png" width="328"></div>
</div>
<div id="chunk-named-setup" class="section level3">
<h3>
<span class="header-section-number">3.8.2</span> Chunk named setup<a class="anchor" aria-label="anchor" href="#chunk-named-setup"><i class="fas fa-link"></i></a>
</h3>
<p>Naming a code block <code>setup</code> means that after you restart RStudio and execute any code in the middle of your markdown document, the <code>setup</code> block will run first. For example, to make sure your libraries are loaded first:</p>
<script src="https://gist.github.com/laurie-platt/c8a1e49cabb5f9fa0104ca6daef5dff2.js"></script>
</div>
</div>
<div id="further-resources-2" class="section level2">
<h2>
<span class="header-section-number">3.9</span> Further resources<a class="anchor" aria-label="anchor" href="#further-resources-2"><i class="fas fa-link"></i></a>
</h2>
<p><a href="https://r4ds.had.co.nz/r-markdown.html">Chapter 27 R Markdown</a>, R4DS by Hadley Wickham.</p>
<p><a href="https://bookdown.org/yihui/bookdown/">Authoring Books and Technical Documents with R Markdown</a> by Yihui Xie is the definitive resource for R Markdown.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="r.html"><span class="header-section-number">2</span> R &amp; RStudio</a></div>
<div class="next"><a href="python.html"><span class="header-section-number">4</span> Python</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#rmd"><span class="header-section-number">3</span> R Markdown</a></li>
<li><a class="nav-link" href="#r-markdown-vs-markdown"><span class="header-section-number">3.1</span> R Markdown vs Markdown</a></li>
<li><a class="nav-link" href="#r-markdown-security-data-protection"><span class="header-section-number">3.2</span> R Markdown security &amp; data protection</a></li>
<li><a class="nav-link" href="#r-notebooks"><span class="header-section-number">3.3</span> R Notebooks</a></li>
<li>
<a class="nav-link" href="#bookdown"><span class="header-section-number">3.4</span> Bookdown</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#themes"><span class="header-section-number">3.4.1</span> Themes</a></li>
<li><a class="nav-link" href="#publishing"><span class="header-section-number">3.4.2</span> Publishing</a></li>
</ul>
</li>
<li><a class="nav-link" href="#flexdashboard"><span class="header-section-number">3.5</span> Flexdashboard</a></li>
<li><a class="nav-link" href="#rolldown"><span class="header-section-number">3.6</span> Rolldown</a></li>
<li>
<a class="nav-link" href="#child-r-markdown"><span class="header-section-number">3.7</span> Child R Markdown</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#iteration"><span class="header-section-number">3.7.1</span> Iteration</a></li></ul>
</li>
<li>
<a class="nav-link" href="#r-markdown-tips"><span class="header-section-number">3.8</span> R Markdown tips</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#markdown-visual-editor"><span class="header-section-number">3.8.1</span> Markdown visual editor</a></li>
<li><a class="nav-link" href="#chunk-named-setup"><span class="header-section-number">3.8.2</span> Chunk named setup</a></li>
</ul>
</li>
<li><a class="nav-link" href="#further-resources-2"><span class="header-section-number">3.9</span> Further resources</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/scc-pi/notes/blob/master/03-rmd.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/scc-pi/notes/edit/master/03-rmd.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Notes</strong>" was written by Laurie Platt. It was last built on 2021-10-07.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
