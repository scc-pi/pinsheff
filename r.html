<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 2 R &amp; RStudio | Notes</title>
<meta name="author" content="Laurie Platt">
<meta name="description" content="2.1 Why script? I initially started scripting in Python to automate some spatial analysis tasks, but soon realised that reproducibility was the main advantage. Iterating, improving a process...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 2 R &amp; RStudio | Notes">
<meta property="og:type" content="book">
<meta property="og:description" content="2.1 Why script? I initially started scripting in Python to automate some spatial analysis tasks, but soon realised that reproducibility was the main advantage. Iterating, improving a process...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 2 R &amp; RStudio | Notes">
<meta name="twitter:description" content="2.1 Why script? I initially started scripting in Python to automate some spatial analysis tasks, but soon realised that reproducibility was the main advantage. Iterating, improving a process...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.0/transition.js"></script><script src="libs/bs3compat-0.3.0/tabs.js"></script><script src="libs/bs3compat-0.3.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="libs/leaflet-1.3.1/leaflet.js"></script><link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="libs/proj4-2.6.2/proj4.min.js"></script><script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script><script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script><script src="libs/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script><link href="libs/HomeButton-0.0.1/home-button.css" rel="stylesheet">
<script src="libs/HomeButton-0.0.1/home-button.js"></script><script src="libs/HomeButton-0.0.1/easy-button-src.min.js"></script><script src="libs/clipboard-0.0.1/setClipboardText.js"></script><link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet">
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Notes</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="github.html"><span class="header-section-number">1</span> Version Control &amp; GitHub</a></li>
<li><a class="active" href="r.html"><span class="header-section-number">2</span> R &amp; RStudio</a></li>
<li><a class="" href="rmd.html"><span class="header-section-number">3</span> R Markdown</a></li>
<li><a class="" href="api.html"><span class="header-section-number">4</span> APIs</a></li>
<li><a class="" href="python.html"><span class="header-section-number">5</span> Python</a></li>
<li><a class="" href="gis.html"><span class="header-section-number">6</span> GIS</a></li>
<li><a class="" href="geocoding.html"><span class="header-section-number">7</span> Postcodes &amp; Addresses</a></li>
<li><a class="" href="public-data.html"><span class="header-section-number">8</span> Public Data Sources</a></li>
<li><a class="" href="databases.html"><span class="header-section-number">9</span> Databases</a></li>
<li><a class="" href="other.html"><span class="header-section-number">10</span> Other</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/scc-pi/notes">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="r" class="section level1">
<h1>
<span class="header-section-number">2</span> R &amp; RStudio<a class="anchor" aria-label="anchor" href="#r"><i class="fas fa-link"></i></a>
</h1>
<div id="why-script" class="section level2">
<h2>
<span class="header-section-number">2.1</span> Why script?<a class="anchor" aria-label="anchor" href="#why-script"><i class="fas fa-link"></i></a>
</h2>
<p>I initially started scripting in Python to automate some spatial analysis tasks, but soon realised that reproducibility was the main advantage. Iterating, improving a process incrementally and at the end verifying the results by re-running the script.</p>
<p>There’s an element of self-documentation with scripting, so it’s easier to return to a scripted task after a bit of time away from it, or pick up a scripted task from a colleague. However, in-line comments and adherence to a style guide make a big difference to just how easy it is. Version control and collaboration are also easier with scripting than GUI tools.</p>
<p>Scripting is not always better than using GUI tools. There’s a good reason that more people use Mac OS and Windows than Unix Bash. Scripting or GUI tools is a horses for courses question, and some GUI workflow tools (e.g. FME, Simul8 and ModelBuilder in ArcGIS) sit somewhere in the middle.</p>
</div>
<div id="style-guide" class="section level2">
<h2>
<span class="header-section-number">2.2</span> Style guide<a class="anchor" aria-label="anchor" href="#style-guide"><i class="fas fa-link"></i></a>
</h2>
<p>Something I need to pay more attention to is following the <a href="https://style.tidyverse.org/">tidyverse style guide</a>, which benefits from supporting tools and familiarity via tidyverse package documentation.</p>
<p>Scripting to the same style guide makes collaboration easier. Which style guide is less important than collaborators scripting to the same style guide.</p>
</div>
<div id="pid" class="section level2">
<h2>
<span class="header-section-number">2.3</span> RStudio security &amp; data protection<a class="anchor" aria-label="anchor" href="#pid"><i class="fas fa-link"></i></a>
</h2>
<div id="workspace" class="section level3">
<h3>
<span class="header-section-number">2.3.1</span> Workspace<a class="anchor" aria-label="anchor" href="#workspace"><i class="fas fa-link"></i></a>
</h3>
<p>To encourage reproducible R scripts, Hadley Wickham recommends not preserving your workspace between sessions. This entails deselecting a couple of options to save and restore <a href="https://bookdown.org/ndphillips/YaRrr/rdata-files.html">.Rdata</a> (see <a href="https://r4ds.had.co.nz/workflow-projects.html#what-is-real">chapter 8 Workflow: projects</a> in Hadley’s R4DS book).</p>
<p>Hadley’s recommendation also reduces the chances of inadvertently sharing PID in a GitHub repository. However, <code>.Rdata</code> should also be included in the <a href="https://git-scm.com/docs/gitignore"><code>.gitignore</code></a> file and the repository set to private (see the section on <a href="github.html#github-security">GitHub security &amp; data protection</a>).</p>
</div>
<div id="passwords" class="section level3">
<h3>
<span class="header-section-number">2.3.2</span> Passwords<a class="anchor" aria-label="anchor" href="#passwords"><i class="fas fa-link"></i></a>
</h3>
<p>It’s poor practice to include login details in code. I use the <code>.Renviron</code> file option for <a href="https://db.rstudio.com/best-practices/managing-credentials/#use-environment-variables">securing credentials</a>. However, if you’re sharing the script you can anticipate that the environment variable might not be set and use the RStudio API to prompt for credentials. For example:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">portal_pwd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span><span class="op">(</span><span class="st">"portal_pwd"</span><span class="op">)</span>
<span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">portal_pwd</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">{</span>
  <span class="va">portal_pwd</span> <span class="op">&lt;-</span> <span class="fu">rstudioapi</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rstudioapi/man/askForPassword.html">askForPassword</a></span><span class="op">(</span><span class="st">"Portal password"</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
</div>
<div id="getting-started" class="section level2">
<h2>
<span class="header-section-number">2.4</span> Getting started<a class="anchor" aria-label="anchor" href="#getting-started"><i class="fas fa-link"></i></a>
</h2>
<p>I’m not going to provide advice on getting started, other than signposting to the excellent resources listed on the RStudio beginners page:</p>
<p><a href="https://education.rstudio.com/learn/beginner/">RStudio Education - Beginners</a></p>
</div>
<div id="rstudio-tips" class="section level2">
<h2>
<span class="header-section-number">2.5</span> RStudio tips<a class="anchor" aria-label="anchor" href="#rstudio-tips"><i class="fas fa-link"></i></a>
</h2>
<div id="code-display" class="section level3">
<h3>
<span class="header-section-number">2.5.1</span> Code display<a class="anchor" aria-label="anchor" href="#code-display"><i class="fas fa-link"></i></a>
</h3>
<p>A few non-default Global Options, under Code and Display, make it a little easier to read and write code:</p>
<ul>
<li><p>Show margin (aim to limit a line of code to 80 characters)</p></li>
<li><p>Highlight R function calls</p></li>
<li><p>Rainbow parentheses (since RStudio v1.4)</p></li>
</ul>
<div class="inline-figure"><img src="images/code-display.png" width="317"></div>
</div>
<div id="document-outline-headings" class="section level3">
<h3>
<span class="header-section-number">2.5.2</span> Document outline &amp; headings<a class="anchor" aria-label="anchor" href="#document-outline-headings"><i class="fas fa-link"></i></a>
</h3>
<p>Code sections and subsections are useful:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Prefix a section with a hash tag and suffix with 4 or more dashes ----</span>
<span class="co">## Subsections have additional hash tags ----</span></code></pre></div>
<p>The sections can be collapsed and are also listed in the document outline pane:</p>
<div class="inline-figure"><img src="images/doc-outline.png" width="181"></div>
</div>
<div id="viewpipesteps-addin" class="section level3">
<h3>
<span class="header-section-number">2.5.3</span> ViewPipeSteps addin<a class="anchor" aria-label="anchor" href="#viewpipesteps-addin"><i class="fas fa-link"></i></a>
</h3>
<p>The <a href="https://r4ds.had.co.nz/pipes.html">pipe</a> <code>%&gt;%</code> is useful for reading and writing code, but can make debugging cumbersome. The <code>ViewPipeSteps</code> addin lets you view the output of your pipe chain after each step. To install:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"daranzolin/ViewPipeSteps"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ViewPipeSteps</span><span class="op">)</span></code></pre></div>
<p>To use:</p>
<div class="inline-figure"><img src="images/view-pipe-steps.png" width="178"></div>
</div>
<div id="shortcuts" class="section level3">
<h3>
<span class="header-section-number">2.5.4</span> Shortcuts<a class="anchor" aria-label="anchor" href="#shortcuts"><i class="fas fa-link"></i></a>
</h3>
<p>RStudio has lots of shortcuts. What you find most useful is down to preference and the areas of the IDE you use most often. These are the shortcuts I’ve found most useful:</p>
<div class="inline-table"><table class="table table-sm"><tbody>
<tr class="odd">
<td>Ctrl + Enter</td>
<td>run selected lines</td>
</tr>
<tr class="even">
<td>Ctrl + Alt + P</td>
<td>re-run previous</td>
</tr>
<tr class="odd">
<td>Ctrl + Shift + C</td>
<td>comment/uncomment lines</td>
</tr>
<tr class="even">
<td>Ctrl + Alt + A</td>
<td>reformat code</td>
</tr>
<tr class="odd">
<td>Ctrl + Shift + R</td>
<td>insert section</td>
</tr>
<tr class="even">
<td>Alt + -</td>
<td>assignment operator &lt;-</td>
</tr>
<tr class="odd">
<td>Ctrl + Shift + M</td>
<td>pipe operator %&gt;%</td>
</tr>
<tr class="even">
<td>Ctrl + left mouse button</td>
<td>View the object clicked</td>
</tr>
<tr class="odd">
<td>Ctrl + Shift + F10</td>
<td>Restart R session</td>
</tr>
<tr class="even">
<td>Ctrl + Shift + P</td>
<td>Command palette</td>
</tr>
</tbody></table></div>
<p><em>TODO</em> <br>
- <em>Write settings</em></p>
</div>
</div>
<div id="further-resources" class="section level2">
<h2>
<span class="header-section-number">2.6</span> Further resources<a class="anchor" aria-label="anchor" href="#further-resources"><i class="fas fa-link"></i></a>
</h2>
<p><a href="https://www.r-bloggers.com/2021/03/5-tips-for-writing-clean-r-code-leave-your-code-reviewer-commentless/">5 tips for writing clean R code</a>, by Marcin Dubel in R bloggers (15 March 2021)</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="github.html"><span class="header-section-number">1</span> Version Control &amp; GitHub</a></div>
<div class="next"><a href="rmd.html"><span class="header-section-number">3</span> R Markdown</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#r"><span class="header-section-number">2</span> R &amp; RStudio</a></li>
<li><a class="nav-link" href="#why-script"><span class="header-section-number">2.1</span> Why script?</a></li>
<li><a class="nav-link" href="#style-guide"><span class="header-section-number">2.2</span> Style guide</a></li>
<li>
<a class="nav-link" href="#pid"><span class="header-section-number">2.3</span> RStudio security &amp; data protection</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#workspace"><span class="header-section-number">2.3.1</span> Workspace</a></li>
<li><a class="nav-link" href="#passwords"><span class="header-section-number">2.3.2</span> Passwords</a></li>
</ul>
</li>
<li><a class="nav-link" href="#getting-started"><span class="header-section-number">2.4</span> Getting started</a></li>
<li>
<a class="nav-link" href="#rstudio-tips"><span class="header-section-number">2.5</span> RStudio tips</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#code-display"><span class="header-section-number">2.5.1</span> Code display</a></li>
<li><a class="nav-link" href="#document-outline-headings"><span class="header-section-number">2.5.2</span> Document outline &amp; headings</a></li>
<li><a class="nav-link" href="#viewpipesteps-addin"><span class="header-section-number">2.5.3</span> ViewPipeSteps addin</a></li>
<li><a class="nav-link" href="#shortcuts"><span class="header-section-number">2.5.4</span> Shortcuts</a></li>
</ul>
</li>
<li><a class="nav-link" href="#further-resources"><span class="header-section-number">2.6</span> Further resources</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/scc-pi/notes/blob/master/02-r.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/scc-pi/notes/edit/master/02-r.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Notes</strong>" was written by Laurie Platt. It was last built on 2021-09-06.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
